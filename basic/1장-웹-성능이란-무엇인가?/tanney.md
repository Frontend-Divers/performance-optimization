# 1장 웹 성능이란 무엇인가?

## 1.1 웹

<br>

### 웹
인터넷 상에서 하이퍼텍스트를 바탕으로 관련있는 문서끼리 연결한 집합체
   > 하이퍼텍스트<br>
   > `참조`를 통해 한 문서에서 다른 문서로 접근할 수 있는 텍스트
   > 하이퍼텍스트 문서에는 단순 텍스트 뿐만 아니라 다양한 컨텐츠 형식을 담을 수 있다.

<br>

### 웹의 구성 요소
  1. URL(Uniform Resource Location)
     - 웹 자원이 인터넷상 어느 위치(Location)에 존재하는지 알려주는 방법
     - 자원의 식별자(Identifier)인 URI의 한 종류
     - URL은 프로토콜, 도메인, 자원의 경로 등으로 이루어진다.
  2. 네트워크 프로토콜
     - 주로 HTTP(HTTPS)를 사용
     - HTTP는 정보를 주고 받는 header와 실제 데이터를 주고 받는 payload(or body)로 이루어져 있다.
  3. HTML(HyperText Mark-up Language)
     - tag를 사용해 다양한 컨텐츠를 브라우저에 보여주는 언어
     - 페이지 문서의 단락 등 구조를 표현하기도 한다.
     - 일반적으로 서버는 HTML문서를 브라우저에게 전달한다.

<br>

## 1.2 웹 성능이 중요한 이유

<br>

- 웹 성능은 사용자에게 웹 컨텐츠나 서비스를 얼마나 빠르게 전달하는지에 대한 성능을 의미한다.
- 웹 로딩 시간과 관련이 깊다.
- 웹 로딩 시간은 실제 사용자들의 이탈률, 서비스 이용률 등에 영향을 준다.
- 직접적으로 매출에 영형을 주지는 않아도 '느린 사이트'라는 인식은 좋지 못한 선입견을 갖게한다.
- 일반적으로 3초 안에 로딩이 완료되는 것을 목표로 한다.
- 글로벌 서비스의 경우 느린 네트워크 환경을 고려한 웹 성능 최적화를 고민해야한다.

<br>

## 1.3 웹 성능 측정 방법

<br>

- 웹 성능을 측정하려면 성능에 영향을 주는 요소(사용자 환경, 공급자 환경, 전달 환경 등)를 파악하고 성능을 측정할 수 있는 도구를 선택해야한다.

<br>

### 성능에 영향을 주는 요소
1. 사용자 환경
    - 사용자의 거주 지역, 네트워크 환경, 브라우저 등
2. 공급자 환경
    - DNS 응답 속도, 웹 서버 응답 속도, 백엔드 처리 속도, 프론트엔드 최적화 여부 등
3. 전달 환경
    - 물리적인 네트워크 인프라 등

<br>

### 웹 성능 측정 도구

1. 크롬 브라우저 개발자 도구
   - 네트워크 탭에서 DOMContentLoaded시간, Load 시간 등과 각 리소스의 waterfall 등을 확인할 수 있다.
2. WebPageTest 서비스
   - 세계 여러 위치에서 로딩 속도를 테스트할 수 있는 서비스이다.
   - 실제 유선망, 모바일 망의 네트워크, 다양한 기기, 브라우저를 곳곳에 설치하여 실제 사용자 환경에서의 테스트를 제공한다.
3. 구글 PageSpeed
   - PSI(PageSpeed Insights) 모듈을 통해 성능 최적화 요소를 평가할 수 있다.
   - 여러 모듈을 통해 성능 최적화 자체를 수행할 수도 있다.

<br>

## 1.4 웹 성능 지표

<br>

- 책 `웹 사이트 최적화 기법`의 저자 스티브 사우더스는 여러 성능 최적화 기법을 프론트엔드, 백엔드, 네트워크 기술로 구분하여 작성했다.
    ![웹최적화기법-스티브사우더스](https://user-images.githubusercontent.com/57767891/145177535-f4f05a39-14b5-4de4-a5a6-02d1e36835ec.jpeg)
- 웹 성능 측정도구인 [YSlow](http://yslow.org/)에서는 위 항목을 바탕으로 웹 성능 지표를 정했다.

<br>

### 사용자 환경(프론트엔드)에서의 성능
- 프론트엔드에서의 성능은 빠르고 보기 쉽게 컨텐츠를 전달하는지와 관련이 깊다. 
- 자세한 내용은 뒤에서 다루도록한다.
- 1.3장에서는 프론트엔드를 공급자 환경으로 분류했던 것 같은데...

<br>

### 공급자 환경(백엔드)에서의 성능
- 실제로 컨텐츠를 생산하고 저장하며 전달하는 일들에 대한 성능
- 여러 언어로 구현되는 백엔드 서비스 자체 성능 뿐만 아니라 데이터베이스, 라우터, 네트워크 스위치 성능도 포함한다.

<br>

### 전달환경(네트워크)
- 일반적으로 전달환경의 성능은 대역폭과 지연시간에 영향을 받는다.
- ISP(Internet Service Provider)가 제공하는 품질에 의존한다.

<br>

## 1.5 웹 성능과 프론트엔드
- 프론트엔드는 데이터를 표현하고 사용자가 입력한 데이터를 백엔드에 전달하기도 한다.
- 프론트엔드의 성능은 사용자의 브라우저에서 측정한다.

<br>

### 브라우저 렌더링 시 성능 지표
- FCP(First Contentful Paint): 첫 번째 텍스트 또는 이미시가 표시되는 데 걸린 시간
- SI(Speed Index): 페이지 컨텐츠가 얼마나 빨리 표시되는지 ([참고](https://developer.mozilla.org/en-US/docs/Glossary/Speed_index))
- LCP(Largest Contentful Paint): 가장 큰 텍스트 또는 이미지가 표시된 시간
- TTI(Time to Interactive): 사용자와 페이지가 상호작용할 수 있게 된 시간
- TBT(Total Blocking Time): FCP와 TTI사이 모든 시간의 합
- CLS(Cumulative Layout Shift): 표시영역 안에 보이는 요소들이 얼마나 이동하는지에 대한 정보

<br>

## 1.6 웹 성능 예산
- 성능 예산이란 성능에 영향을 미치는 다양한 요소를 제어하는 한곗값을 의미한다.

<br>

### 정량 기반 지표
- 이미지, 스크립트, 폰트 등 웹 페이지 제작에 필요한 요소들에 대한 한곗값이다.
- 예를 들어 다음과 같은 요소를 포함한다.
  - 이미지 파일의 최대 크기
  - 최대 웹 폰트 파일 수
  - 자바스크립트 파일 크기 합
  - 타사 스크립트 수

<br>

### 시간 기반 지표
- 단순히 정량 지표가 모든 성능을 좌우하지는 않는다. 같은 크기, 같은 수의 리소스라도 호출 시점에 따라 성능이 달라지기도한다.
- 이를 보완하는 예산이 시간 기반 지표이다.
- 시간 기반 지표는 실제 브라우저에서 발생하는 웹 성능 이벤트들(FCP, TTI 등)의 한곗값을 의미한다.

<br>

### 규칙 기반 지표
- Lighthouse, WebPageTest 등의 성능 점수를 이용하는 방법
- 점수를 통해 유사 사이트와 비교할 수도 있고, 어느 부분을 개선 포인트로 삼아야하는지도 발견할 수 있다.
- 사내에서 자체적으로 웹 성능 지표에 대한 테스트 케이스를 만들고 자동화를 통해 성능을 지표화 하는 방식을 이용하기도 한다.